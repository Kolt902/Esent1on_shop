#!/bin/bash

# Специальный скрипт запуска для Railway
# Задержка перед запуском проверки здоровья

# Функция для очистки при завершении
cleanup() {
  echo "Завершение работы приложения..."
  kill -TERM $NODE_PID
  exit 0
}

# Перехват сигналов для корректного завершения
trap cleanup SIGINT SIGTERM

# Запускаем приложение в фоновом режиме
echo "Запуск сервера..."
node dist/index.js &
NODE_PID=$!

# Выводим PID для диагностики
echo "Приложение запущено с PID: $NODE_PID"

# Ожидаем завершения приложения
wait $NODE_PID